#include "spi.h"
#include "ssd1306.h"
#include "servo.h"
#include "can.h"
#include <stdio.h>

int main(void) {
    SPI1_Init();
    SSD1306_Init();
    Servo_Init();
    CAN_Init();

    uint8_t angle = 0;
    char buf[16];

    while (1) {
        if (CAN_ReadAngle(&angle)) {
            Servo_SetAngle(angle);

            SSD1306_Clear();
            SSD1306_GotoXY(0, 0);
            sprintf(buf, "Angle: %d", angle);
            SSD1306_Puts(buf, &Font_6x8, WHITE);
            SSD1306_Update();
        }
    }
}
